function printLog(n){console.log("------Log Report------"),console.log(new Date),console.log(n),console.log("------##########------")}function printError(n){typeof n=="object"?(n.message&&(console.log("------Error Message------"),console.log("\nMessage: "+n.message)),n.stack&&console.log(n.stack),console.log("------#############------")):console.log("printError :: argument is not an object")}function contains(n,t){for(var i in t)if(n.match(t[i]))return!0;return!1}function extend(){var e,u,i,t,o,s,n=arguments[0]||{},r=1,h=arguments.length,f=!1;for(typeof n=="boolean"&&(f=n,n=arguments[1]||{},r=2),typeof n=="object"||jQuery.isFunction(n)||(n={}),h===r&&(n=this,--r);r<h;r++)if((e=arguments[r])!=null)for(u in e)(i=n[u],t=e[u],n!==t)&&(f&&t&&(jQuery.isPlainObject(t)||(o=jQuery.isArray(t)))?(o?(o=!1,s=i&&jQuery.isArray(i)?i:[]):s=i&&jQuery.isPlainObject(i)?i:{},n[u]=jQuery.extend(f,s,t)):t!==undefined&&(n[u]=t));return n}function tQEraUploader(n){function it(n){return n.drop?n.dropPlace?(n.dropPlace.ondragover=function(){return this.className.match(n.dragHoverClass)||(this.className+=" "+n.dragHoverClass),!1},n.dropPlace.ondragleave=function(){return this.className.match(n.dragHoverClass)&&(this.className=this.className.replace(n.dragHoverClass,"")),!1},n.dropPlace.ondrop=function(n){return this.className.match(t.dragHoverClass)&&(this.className=this.className.replace(t.dragHoverClass,"")),l(n.dataTransfer.files),!1},!0):!1:!0}function nt(n){return n.imageHolder?!0:!1}function k(n){return n.file_input&&n.file_input.tagName=="INPUT"&&n.file_input.type=="file"?(n.file_input.addEventListener("change",p,!1),!0):!1}function g(n){if(n.file_filter){var t=n.file_filter.split("|");return t.length<1?!1:(a=t,!0)}return!1}function d(n){return n.image_thumb?n.image_thumb_width&&n.image_thumb_height?n.image_thumb_width>10&&n.image_thumb_height>10?!0:(t.error("Thumbnail must be higher than 10x10"),!1):!1:!0}function tt(n){return parseInt(n.file_size)?!0:(t.error("File size must be integer"),!1)}function ut(n){return n.form?!0:!1}function rt(n){var r,i;try{r=document.createElement("div"),r.id=n,r.className=t.file_class,i=document.createElement("a"),i.className=t.file_closebutton_class,i.href="javascript:void(0)",i.textContent="Ã—",i.addEventListener("click",s,!1),r.appendChild(i),r.appendChild(e),t.imageHolder.appendChild(r),t.imageHolder.appendChild(e)}catch(u){t.error("Create image problem")}}function l(n){for(var r in n)typeof n[r]=="object"&&(contains(n[r].type,a)?n[r].size<t.file_size?t.limit==0?o.push(n[r]):i.length<=t.limit?o.push(n[r]):t.error("Upload limit is "+t.limit):t.error("File size to bigger"):t.error("File doesn't support"));h()}function p(n){l(n.target.files)}function h(){var r=o.shift(),n;if(r!=null){if(t.limit!=0&&i.length+1>t.limit)return t.error("Limit are "+t.limit),!1;n="temp_"+ +new Date,rt(n),y.push(n),v(n,r)}}function v(n,r){var o=new FileReader,e=document.getElementById(n),f,u;o.onload=function(n){if(n.preventDefault(),isCanvasText&&r.type.match("image")){var o=document.createElement("canvas"),c=o.getContext("2d"),f=document.createElement("canvas"),s=f.getContext("2d"),u=new Image;u.onload=function(){var p=1,l,a;if(u.width>t.image_thumb_width?p=t.image_thumb_width/u.width:u.height>t.image_thumb_height&&(p=t.image_thumb_height/u.height),f.width=u.width,f.height=u.height,s.drawImage(u,0,0),t.watermark.text){l=document.createElement("canvas"),a=l.getContext("2d"),l.width=u.width,l.height=u.height,a.fillStyle=t.watermark.color,a.font=t.watermark.font_size+" "+t.watermark.font,a.globalAlpha=t.watermark.alpha;var b=a.measureText(t.watermark.text),y=t.watermark.font_size.match("px")?t.watermark.font_size.replace("px",""):t.watermark.font_size,v=0,w=y;t.watermark.position.match("bottom")?w=u.height-y*.3:t.watermark.position.match("top")?v=0+y*.3:t.watermark.position.match("center")&&(w=(u.height-y)/2),t.watermark.position.match("left")?v=0:t.watermark.position.match("mid")?v=(u.width-b.width)/2:t.watermark.position.match("right")&&(v=u.width-b.width),a.translate(v,w),a.fillText(t.watermark.text,0,0),s.drawImage(l,0,0,l.width,l.height,0,0,l.width,l.height)}o.width=u.width*p,o.height=u.height*p,c.drawImage(f,0,0,f.width,f.height,0,0,o.width,o.height),i.push({data:f.toDataURL(r.type),name:r.name,id:e.id}),t.image_thumb&&(o.style.cursor="pointer",o.onclick=function(){var n=window.open(f.toDataURL(r.type),"_blank");n.focus()},e.appendChild(o)),h(),delete f,delete s},u.src=this.result}else i.push({data:this.result,name:r.name}),h()},f=document.createElement("p"),u="",u=r.size>1e6?Math.round(r.size/1048576)+" MB":Math.round(r.size/1024)+" KB",f.textContent=r.name+" "+u,e.appendChild(f),o.readAsDataURL(r)}function s(n){var r,u;if(typeof n=="object")s(n.toElement.parentNode.id);else for(r in i)i[r].id==n&&(i.splice(r,1),u=document.getElementById(n),t.imageHolder.removeChild(u))}function b(n){var u,r;n.preventDefault();for(u in i)r=new XMLHttpRequest,r.open("POST",t.ajax.url,!0),r.setRequestHeader("Content-type",i[u].data.split(",")[0]),r.upload.template_id=i[u].id,r.onreadystatechange=c,r.upload.addEventListener("load",c,!1),r.upload.addEventListener("progress",w,!1),r.setRequestHeader("Uploader-Thumb",t.image_thumb),r.setRequestHeader("Uploader-ThumbHeight",t.image_thumb_height),r.setRequestHeader("Uploader-ThumbWidth",t.image_thumb_width),r.send(i[u].data);return!1}function w(n){if(t.progress){var i=n.totalSize*100/n.position;t.progress({percent:i,template:n.target.template_id}),t.ajax.clearAfterUpload&&setTimeout(s,1500,n.target.template_id)}}function c(n){n.target.readyState==4&&n.target.status==200&&t.success&&(printLog({percent:100,template:n.target.upload.template_id}),t.progress({percent:100,template:n.target.upload.template_id}),t.success(n))}var f,r,u;n=extend(!0,defaultSettings,n||{});var a,t=n,e=document.createElement("div"),o=[],i=[],y=[];if(this.settings=t,!isHTML5()){f=document.createElement("input"),f.type="hidden",f.name="ThumbWidth",f.id="ThumbWidth",f.value=t.image_thumb_width,r=document.createElement("input"),r.type="hidden",r.name="ThumbHeight",r.id="ThumbHeight",r.value=t.image_thumb_height,u=document.createElement("input"),u.type="hidden",u.name="Thumb",u.id="Thumb",u.value=t.image_thumb,t.form.appendChild(u),t.form.appendChild(f),t.form.appendChild(r),n.html5Error(this);return}if(location.hostname=="www.tqera.com"){if(!it(t))return printLog("Drop Place can't initialize")&&!1;if(!nt(t))return printLog("Image Holder can't initialize")&&!1;if(!k(t))return printLog("File Input can't initialize")&&!1;if(!g(t))return printLog("File Filter can't initialize")&&!1;if(!d(t))return printLog("Image Properties (thumb, width, height) can't initialize")&&!1;if(!tt(t))return printLog("File Size can't initialize")&&!1;if(!ut(t))return printLog("File Form can't initialize")&&!1;n.dropPlace.onclick=function(){t.file_input.click()},t.form.addEventListener("submit",b,!1),e.style.clear="both"}}var defaultSettings={drop:!0,dropPlace:document.getElementById("dropPlace"),dragHoverClass:"hover",imageHolder:document.getElementById("imageHolder"),image_thumb:!0,image_thumb_width:200,image_thumb_height:200,file_input:document.getElementById("fileInput"),file_filter:"image|text",file_size:15e7,file_class:"file",file_closebutton_class:"close",limit:0,ajax:{url:"",clearAfterUpload:!0},form:document.getElementById("imageForm"),watermark:{text:"www.yourweb.com",color:"grey",alpha:1,font_size:"55px",font:"bold sans-serif",position:"top mid"},html5Error:function(){printLog("Not Html5 Support")},success:function(){printLog("Pictures sended.")},progress:function(n){printLog("Picture "+n)},error:function(){},debug:!1},isLocalStorage=function(){try{return localStorage.setItem(mod,mod),localStorage.removeItem(mod),!0}catch(n){return!1}},isCanvas=function(){var n=document.createElement("canvas");return!!(n.getContext&&n.getContext("2d"))},isCanvasText=function(){return!!(isCanvas()&&is(document.createElement("canvas").getContext("2d").fillText,"function"))},isHTML5=function(){return isCanvasText&&isLocalStorage&&window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData}